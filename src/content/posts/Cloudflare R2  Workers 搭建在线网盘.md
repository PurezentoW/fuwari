---
title: Cloudflare R2 Workers æ­å»ºåœ¨çº¿ç½‘ç›˜
published: 2025-07-30
description: ''
image: 'https://cdn.wcxian.cc/img/20250828153336785.png'
tags: [Cloudflare,Workers]
category: 'æŠ€æœ¯åˆ†äº«'
draft: false 
lang: ''
---
# åˆ©ç”¨ Cloudflare R2 Workers æ­å»ºåœ¨çº¿ç½‘ç›˜



## 0.å‰è¨€

Cloudflare æ˜¯ä¸€å®¶æä¾›ç½‘ç«™åŠ é€Ÿå’Œå®‰å…¨æœåŠ¡çš„å…¬å¸ã€‚ä¸»è¦åŠŸèƒ½åŒ…æ‹¬ï¼š**CDN åŠ é€Ÿ** ã€**DDoS é˜²æŠ¤**ã€**DNS æœåŠ¡**ã€**åå‘ä»£ç†** ç­‰åŠŸèƒ½ã€‚

æˆ‘ä»¬è®¿é—®ä¸€äº›ç½‘ç«™çš„æ—¶å€™ï¼Œç»å¸¸å¯ä»¥çœ‹åˆ°è¿™æ ·ä¸€ä¸ªäººæœºéªŒè¯é¡µé¢ï¼Œè¿™å°±æ˜¯Cloudflareæä¾›çš„å…è´¹æœåŠ¡ä¹‹ä¸€ã€‚



![img](https://cdn.wcxian.cc/img/20250725232201487.png)

å®ƒå¯ä»¥å…è´¹CDNåŠ é€Ÿï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥éšè—æˆ‘ä»¬æœåŠ¡å™¨çš„çœŸå®ipåœ°å€ï¼Œè¿˜èƒ½å…è´¹å¼€å¯æ”»å‡»é˜²å¾¡ã€‚



## 1.Cloudflare R2

å¯¹è±¡å­˜å‚¨ç›¸ä¿¡å¾ˆå¤šäººéƒ½æœ‰æ‰€è€³é—»ï¼Œä¾‹å¦‚è…¾è®¯äº‘ COSã€é˜¿é‡Œäº‘ OSSã€ä¸ƒç‰›äº‘ KODO ç­‰ã€‚

é‚£ä¹ˆï¼Œä¸ºä»€ä¹ˆæˆ‘ä»¬è¿˜è¦ä½¿ç”¨ Cloudflare R2 å‘¢ï¼Ÿç­”æ¡ˆåœ¨äºå®ƒæ‹¥æœ‰ç‹¬ç‰¹çš„ä¼˜åŠ¿ï¼šä¸é™è®¿é—®æµé‡ã€‚

å¯¹äºå¯¹è±¡å­˜å‚¨æ¥è¯´ï¼Œæµé‡è´¹ç”¨æ˜¯ä¸€é¡¹ä¸å°çš„æ”¯å‡ºã€‚Cloudflare ç›´æ¥å…é™¤æµé‡è´¹ç”¨ï¼Œå ªç§°æ…ˆå–„å¤§ä½›ã€‚

| ç±»å‹     | å…è´¹é¢åº¦           | è¶…é¢ä»˜è´¹          |
| -------- | ------------------ | ----------------- |
| å­˜å‚¨     | 10 GB-æœˆ/æœˆ        | $0.015/GB/æœˆ      |
| A ç±»æ“ä½œ | 100 ä¸‡ä¸ªè¯·æ±‚ / æœˆ  | $4.50/100ä¸‡ä¸ªè¯·æ±‚ |
| B ç±»æ“ä½œ | 1000 ä¸‡ä¸ªè¯·æ±‚ / æœˆ | $0.36100ä¸‡ä¸ªè¯·æ±‚  |
| å‡ºå£æµé‡ | å…¨çƒå…è´¹â‘           | å…¨çƒå…è´¹â‘          |

Cloudflare R2 ä¸»è¦é å­˜å‚¨å®¹é‡æ”¶è´¹ï¼Œ10G ä»¥å†…æ˜¯å…è´¹çš„ï¼Œå¯¹äºå†™å†™åšå®¢åšä¸ªå›¾åºŠå®Œå…¨æ˜¯å¤Ÿç”¨çš„ã€‚å°±ç®—æ˜¯æ”¶è´¹ä¹Ÿä¸è´µï¼Œ100G å·®ä¸å¤šä¹Ÿå°± 10 å¤§æ´‹å¤šç‚¹ã€‚A ç±»æ“ä½œå’Œ B ç±»æ“ä½œæ˜¯æŒ‡ä¸€äº›è¯»å†™æ“ä½œï¼Œåº”è¯¥æ²¡æœ‰å¤šå°‘ç½‘ç«™èƒ½è¶…è¿‡è¿™ä¸ªæ•°ã€‚æ€»çš„æ¥è¯´ï¼Œçš„ç¡®å¤Ÿå®æƒ ã€‚

## 2.è´¦æˆ·é…ç½®

### æ³¨å†Œè´¦å·

é¦–å…ˆä½ å¾—æœ‰ä¸ª Cloudflare è´¦å·

[éšæ—¶éšåœ°è¿æ¥ã€ä¿æŠ¤ã€æ„å»º | Cloudflare](https://www.cloudflare.com/zh-cn/)

### æ·»åŠ è®¢é˜…

å’Œå…¶ä»– CF å…è´¹æœåŠ¡ä¸åŒï¼Œ**R2 è¶…å‡ºå…è´¹é¢åº¦åä¸æ˜¯è‡ªåŠ¨åœç”¨ç­‰å¾…ä¸‹ä¸ªæœˆé¢åº¦æ¢å¤ï¼Œè€Œæ˜¯æ‰£é’±æŒ‰é‡ä»˜è´¹**ï¼Œå› æ­¤éœ€è¦ç»‘å®šä¸€ä¸ªæ”¯ä»˜æ‰‹æ®µã€‚å› ä¸ºæˆ‘ä¹‹å‰åœ¨ CF è´­ä¹°åŸŸåæ·»åŠ äº† paypal (ç»‘å®šæ‹›è¡Œçš„äººæ°‘å¸å€Ÿè®°å¡)ï¼Œå› æ­¤å¯ä»¥ç›´æ¥ä½¿ç”¨ paypalã€‚ï¼ˆå®é™…ä¸Šç»™çš„å…è´¹é¢åº¦ä¹Ÿååˆ†å……è£•ï¼Œå¯¹äºä¸ªäººä¹ƒè‡³ä¸€å¤§å¨äººä½¿ç”¨çš„å›¾åºŠå·²ç»è¶³å¤Ÿäº†ï¼‰

![image-20250725210753490](https://cdn.wcxian.cc/img/20250725232208133.png)

### åˆ›å»º R2 å‚¨å­˜æ¡¶

å‰å¾€ Cloudflare R2 æ–°å»ºä¸€ä¸ª R2 å‚¨å­˜æ¡¶ã€‚

![image-20250725140047125](https://cdn.wcxian.cc/img/20250725232211333.png)

è®¾ç½®ä½ çš„å­˜å‚¨æ¡¶åï¼Œåç§°éšæ„è®¾ç½®ï¼Œç„¶åç‚¹å‡»åˆ›å»ºã€‚

![image-20250725140239298](https://cdn.wcxian.cc/img/20250725232214506.png)

- å­˜å‚¨æ¡¶åç§°ï¼šè‡ªå·±å¡«å†™
- ä½ç½®ï¼š**äºšå¤ªåœ°åŒº** æˆ– **åŒ—ç¾æ´²è¥¿éƒ¨** (å®é™…é€Ÿåº¦å·®ä¸å¤š)
- é»˜è®¤å­˜å‚¨ç±»ï¼šæ ‡å‡†ï¼ˆä¸èƒ½é€‰**ä¸é¢‘ç¹è®¿é—®**ï¼Œæ²¡æœ‰å…è´¹é¢åº¦ï¼‰

### é€šè¿‡r2.devå­åŸŸåè®¿é—®

**ï¼ˆç¬¬ä¸€ç§æ–¹æ³•ï¼Œä¸æ¨èä½¿ç”¨ï¼Œå¯ç›´æ¥å¿½ç•¥æ­¤æ­¥éª¤ï¼‰** åœ¨å‚¨å­˜æ¡¶è®¾ç½®ä¸­ R2.dev å­åŸŸ å…è®¸å…¬å¼€è®¿é—®ï¼Œå¤åˆ¶å…¬å…±å‚¨å­˜æ¡¶ URLã€‚ å¦‚å¼€å¯ R2 å­˜å‚¨æ¡¶çš„å…¬å¼€è¯»å†™æƒé™ï¼ä½ çš„å­˜å‚¨èµ„æºæœ‰å¯èƒ½ä¼šè¢«æ¶æ„åˆ·å–ï¼Œé€ æˆèµ„æºä»˜è´¹ã€‚

å¼€å¯äº†ä¼šè·å¾—ä¸€ä¸ªå…¬å…± R2.dev å­˜å‚¨æ¡¶ URL

``` 
https://pub-*****.r2.dev
```

![image-20250725142731633](https://cdn.wcxian.cc/img/20250725232217583.png)

### ä½¿ç”¨è‡ªå®šä¹‰åŸŸè®¿é—®

**ï¼ˆç¬¬äºŒç§æ–¹æ³•ï¼Œæ¨èä½¿ç”¨ï¼‰** ä½¿ç”¨R2çš„ è‡ªå®šä¹‰åŸŸå æ‚¨çš„å­˜å‚¨æ¡¶çš„å†…å®¹å°†å¯ä»¥é€šè¿‡è¯¥åŸŸå…¬å¼€è®¿é—®ã€‚è¿æ¥çš„ç½‘ç«™è¿˜å¯ä»¥å—ç›Šäº Cloudflare åŠŸèƒ½ï¼Œå¦‚æœºå™¨äººç®¡ç†ã€è®¿é—®å’Œç¼“å­˜ã€‚

![image-20250725143106417](https://cdn.wcxian.cc/img/20250725232220433.png)

![image-20250725143142794](https://img2.wcxian.cc/img/2025/07/3f6996a3807903f9d38a74dfb3941457.png)

## 3.åˆ›å»º Cloudflare Pages ç«™ç‚¹

### Fork ä»“åº“

åœ¨ Github Fork é¡¹ç›®

[willow-god/FlareDrive-R2: ğŸ˜åŸºäºcloudflare-r2å®ç°çš„ç½‘ç›˜ï¼Œå¯ä»¥å®ç°æ–‡ä»¶åˆ†äº«åŠŸèƒ½](https://github.com/willow-god/FlareDrive-R2)

### åˆ›å»ºç«™ç‚¹

![image-20250725140904848](https://cdn.wcxian.cc/img/20250725232223603.png)

![image-20250725143340327](https://cdn.wcxian.cc/img/20250725232226686.png)

å‰å¾€ Cloudflare Pagesï¼Œæ–°å»ºç«™ç‚¹ï¼Œé€‰æ‹©è¿æ¥åˆ° Gitï¼Œå¹¶é€‰æ‹©åˆšåˆš Fork çš„ä»“åº“ã€‚ç‚¹å‡»å¼€å§‹è®¾ç½®ã€‚

![image-20250725143450092](https://cdn.wcxian.cc/img/20250725232229438.png)

### ç¯å¢ƒå˜é‡

åœ¨ Cloudflare Pages é¡¹ç›®ä¸­ï¼Œè¿›å…¥ **Settings â†’ Environment Variables** æ·»åŠ ä»¥ä¸‹å˜é‡ï¼š

| å˜é‡å         | ç¤ºä¾‹å€¼                                                | æ˜¯å¦å¿…è¦ | è¯´æ˜                                           |
| -------------- | ----------------------------------------------------- | -------- | ---------------------------------------------- |
| `PUBURL`       | `https://pub-kdsjfhlasnwiuweia4387rfho85tnof4.r2.dev` | âœ… å¿…å¡«   | R2 å…¬å…±å­˜å‚¨æ¡¶åœ°å€                              |
| `admin:123456` | `*`                                                   | âœ… å¿…å¡«   | ç®¡ç†å‘˜è´¦å·ï¼Œæ ¼å¼ä¸º `ç”¨æˆ·å:å¯†ç `               |
| `GUEST`        | `public/`                                             | âŒ å¯é€‰   | æ¸¸å®¢å†™å…¥çš„é»˜è®¤ç›®å½•                             |
| `user1:123456` | `user1/,shared/`                                      | âŒ å¯é€‰   | æ™®é€šç”¨æˆ·åŠå…¶å¯å†™å…¥ç›®å½•ï¼Œæ”¯æŒå¤šä¸ªç›®å½•ï¼Œæ ¼å¼ä¸€è‡´ |

é¡¹ç›®åç§°å¯è‡ªè¡Œä¿®æ”¹ï¼Œå…¶å®ƒé¡¹ç›®ä¿æŒé»˜è®¤è®¾ç½®ã€‚ç‚¹å‡»ç¯å¢ƒå˜é‡å¹¶æ·»åŠ å¦‚ä¸‹å˜é‡ï¼Œè‡ªç”¨åªéœ€è¦è®¾ç½®ä¸ªç®¡ç†å‘˜è´¦å·å°±è¡Œã€‚

![image-20250725165256006](https://cdn.wcxian.cc/img/20250725232234254.png)

### éƒ¨ç½²æˆåŠŸ

![image-20250725143854632](https://cdn.wcxian.cc/img/20250725232237436.png)

### ç»‘å®š R2 å‚¨å­˜æ¡¶

å‰å¾€ Pages > cloudflare-r2-oss > è®¾ç½® > å‡½æ•° > R2 å‚¨å­˜æ¡¶ç»‘å®šï¼Œç»‘å®šå¯¹åº”çš„ R2 å‚¨å­˜æ¡¶ï¼Œå˜é‡åç§°ä¸º BUCKETã€‚

![image-20250725144801141](https://cdn.wcxian.cc/img/20250725232240361.png)

### é‡æ–°éƒ¨ç½²

åœ¨éƒ¨ç½²é¡µé¢ç‚¹å‡»é‡æ–°éƒ¨ç½²æŒ‰é’®ï¼Œå®Œæˆè®¾ç½®åå³å¯æ­£å¼ä½¿ç”¨ã€‚

![image-20250725144928314](https://cdn.wcxian.cc/img/20250725232242913.png)

### è®¾ç½®è‡ªå®šä¹‰åŸŸå

å› ä¸ºæˆ‘çš„åŸŸåå°±åœ¨cloudflare,æ‰€ä»¥å¯ä»¥ç›´æ¥ä¸€é”®è®¾ç½®åŸŸåï¼Œè®¾ç½®å®Œå°±è‡ªåŠ¨æœ‰https

![image-20250725145105169](https://cdn.wcxian.cc/img/20250725232245556.png)

## 4.åœ¨çº¿ç½‘ç›˜

è¿™ä¸‹å°±å¯ä»¥ç›´æ¥è®¿é—®ç½‘ç›˜ä¸»é¡µäº†

https://pan.wcxian.cc/

[/ - ä¼˜é›…çš„ Cloudflare R2 ç½‘ç›˜æ–‡ä»¶åº“](https://pan.wcxian.cc/)

![image-20250725212130895](https://cdn.wcxian.cc/img/20250725232248612.png)


<iframe width="100%" height="468" src="https://img.wcxian.cc/video/bandicam%202025-07-25%2022-47-32-184.mp4" title="YouTube video player" frameborder="0" allowfullscreen></iframe>



## 5.è¶…è¿‡ 300 MB å¤§æ–‡ä»¶ä¸Šä¼ 

è¶…è¿‡ 300 MB çš„æ–‡ä»¶ä»…æ”¯æŒé€šè¿‡ S3 å…¼å®¹æ€§ API æˆ– Workers è¿›è¡Œä¸Šä¼ ã€‚
å› æ­¤ï¼Œå»ºè®®é‡‡ç”¨ PicList æ–¹æ¡ˆè¿›è¡Œè®¾ç½®ï¼Œè¯¦æƒ…è¯·å‚è€ƒæœ¬ç¯‡åšæ–‡ PicList - ä¸€æ¬¾é«˜æ•ˆçš„äº‘å­˜å‚¨å’Œå›¾ç‰‡æ‰˜ç®¡å¹³å°ç®¡ç†å·¥å…·ã€‚

![image-20250727210951564](https://cdn.wcxian.cc/img/20250727212242288.png)

![image-20250727210542347](https://cdn.wcxian.cc/img/20250727212245877.png)

![image-20250727212101268](https://cdn.wcxian.cc/img/20250727212248644.png)

å›¾åºŠé…ç½®å=éšæ„è®¾ç½®
åº”ç”¨å¯†é’¥ID=è®¿é—®å¯†é’¥ ID
åº”ç”¨å¯†é’¥=æœºå¯†è®¿é—®å¯†é’¥
æ¡¶å=ä½ R2å­˜å‚¨æ¡¶åˆ›å»ºçš„åç§°
æ–‡ä»¶è·¯å¾„={fileName}.{extName}
è‡ªå®šä¹‰èŠ‚ç‚¹=å®¢æˆ·ç«¯ä½¿ç”¨ç®¡è¾–æƒåœ°ç‰¹å®šçš„ç»ˆç»“ç‚¹

## 6.Cloudflare R2 + Workers æ–¹æ¡ˆçš„ç‹¬ç‰¹ä¼˜åŠ¿ï¼š

- **æä½æˆæœ¬ï¼š** R2æ ¸å¿ƒä¼˜åŠ¿æ˜¯æ— å‡ºç«™æµé‡è´¹ï¼Œè¿™æ„å‘³ç€å¤§é‡æ•°æ®è®¿é—®ï¼ˆä¾‹å¦‚è§†é¢‘æ’­æ”¾ã€å›¾ç‰‡åŠ è½½ï¼‰ä¸ä¼šäº§ç”Ÿé«˜é¢çš„CDNè´¹ç”¨ã€‚å­˜å‚¨è´¹ç”¨æœ¬èº«ä¹Ÿæå…·ç«äº‰åŠ›ã€‚
- **å…¨çƒè¾¹ç¼˜åŠ é€Ÿï¼š** Cloudflareçš„CDNç½‘ç»œéå¸ƒå…¨çƒï¼ŒWorkersåœ¨è¾¹ç¼˜è¿è¡Œï¼Œæ•°æ®å­˜å‚¨åœ¨R2åï¼Œå¯ä»¥é€šè¿‡Workersåœ¨æœ€è¿‘çš„è¾¹ç¼˜èŠ‚ç‚¹è¿›è¡Œå¤„ç†å’Œåˆ†å‘ï¼Œå®ç°æä½çš„å»¶è¿Ÿã€‚å¯¹äºæ— äººå•†åº—çš„â€œå¿«è¿›â€ä½“éªŒè‡³å…³é‡è¦ã€‚
- **é«˜å¯æ‰©å±•æ€§ï¼š** æ— éœ€å…³å¿ƒæœåŠ¡å™¨æ‰©å®¹ï¼ŒR2å’ŒWorkerså¤©ç”Ÿå…·å¤‡å¼¹æ€§ä¼¸ç¼©èƒ½åŠ›ï¼Œå¯ä»¥åº”å¯¹è®¿é—®é‡çš„ç¬é—´çˆ†å‘ã€‚
- **å†…ç½®å®‰å…¨ï¼š** åˆ©ç”¨Cloudflareçš„DDoSé˜²æŠ¤ã€WAFç­‰èƒ½åŠ›ï¼Œä¸ºç½‘ç›˜æœåŠ¡æä¾›é«˜çº§å®‰å…¨ä¿æŠ¤ã€‚Workerså¯ä»¥å®ç°ç»†ç²’åº¦çš„è®¿é—®æ§åˆ¶å’Œé‰´æƒã€‚
- **å¼€å‘ç®€æ´ï¼š** Workersä½¿ç”¨JavaScript/TypeScriptå¼€å‘ï¼Œç”Ÿæ€æˆç†Ÿï¼Œé—¨æ§›ç›¸å¯¹è¾ƒä½ï¼Œå¯ä»¥å¿«é€Ÿè¿­ä»£å’Œéƒ¨ç½²ã€‚
- **æ˜“äºé›†æˆï¼š** R2å…¼å®¹S3 APIï¼Œå¯ä»¥æ–¹ä¾¿åœ°ä¸ç°æœ‰å·¥å…·å’ŒSDKé›†æˆã€‚Workerså¯ä»¥æš´éœ²æ ‡å‡†çš„APIæ¥å£ä¾›å…¶ä»–ç³»ç»Ÿè°ƒç”¨ã€‚

å‚è€ƒèµ„æ–™ï¼š

> [Cloudflare R2å¯¹è±¡å­˜å‚¨æ­å»ºé«˜é€Ÿå…è´¹å›¾åºŠå®Œå…¨æŒ‡å—å‡ å¹´å‰ï¼Œå½“æˆ‘ç¬¬ä¸€æ¬¡æŠŠåŸŸåæ‰”è¿›Cloudflareçš„æ€€æŠ±æ—¶ï¼Œä»¿ä½› - æ˜é‡‘](https://juejin.cn/post/7471968780865093659)
>
> [Cloudflare R2 + Workersï¼šåœ¨çº¿ç½‘ç›˜ ä½¿ç”¨ Cloudflare Pages å¿«é€Ÿéƒ¨ç½²æ•™ç¨‹ | å‘¨æ¶¦å‘åšå®¢](https://blog.zrf.me/p/Cloudflare-R2-oss/)
>
> [Cloudflare R2 å¯¹è±¡å­˜å‚¨ç™½å«–æŒ‡å—ï¼š10Gå­˜å‚¨+å…æµé‡è´¹ï¼Œæ‰“é€ å…è´¹å›¾åºŠ](https://blog.wpjam.com/article/cloudflare-r2/)